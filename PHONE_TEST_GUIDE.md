# 📱 手机测试指南

## 如何在手机上测试和排查问题

### 第一步：检查必要权限 ✅

#### 1. 存储/照片权限
1. 打开手机 **设置**
2. 进入 **应用** 或 **应用管理**
3. 找到 **悬浮截屏**
4. 点击 **权限**
5. 确保以下权限已开启：
   - ✅ **照片和视频** (Android 13+)
   - ✅ **存储** (Android 12-)
   - ✅ **显示悬浮窗** / **显示在其他应用上层**

#### 2. 网络权限检查
**重要：** 网络权限（INTERNET）是自动授予的，不需要用户手动开启。

**验证网络是否可用：**
在手机浏览器中访问：
```
http://shanghai.idc.matrixorigin.cn:30026/health
```

- ✅ 如果能访问且显示 JSON 数据 → 网络正常
- ❌ 如果无法访问 → 网络或服务器有问题

---

### 第二步：测试流程 🔍

#### 1. 启动App
1. 打开 **悬浮截屏** App
2. 点击 **启动悬浮窗** 按钮
3. 确认屏幕上出现悬浮按钮

#### 2. 进行截图测试
1. 使用**系统截图**功能（通常是 **电源键 + 音量下键**）
2. 观察屏幕上的 Toast 提示

---

### 第三步：根据Toast提示判断问题 💡

现在 App 会显示详细的提示信息，请注意观察：

#### ✅ 正常流程的提示：

**1. 截图后立即显示：**
```
正在识别英雄...
文件大小: XXX KB
```
这说明：
- ✅ 截图被检测到
- ✅ 文件可以访问
- ✅ 即将上传到服务器

**2. 等待后显示（可能需要30秒-2分钟）：**
```
识别成功: 廉颇, 典韦, 安琪拉, 鲁班七号, 瑶
```
这说明：
- ✅ 网络连接正常
- ✅ 服务器响应成功
- ✅ 英雄识别成功

**3. 英雄名字应该自动更新**
面板上的"英雄1"至"英雄5"应该变成实际的英雄名字

---

#### ❌ 常见错误提示及解决方法：

##### 错误1：没有任何Toast提示
**说明：** 截图没有被检测到

**可能原因：**
- 没有授予存储/照片权限
- 截图没有保存在标准目录（DCIM/Screenshots/）

**解决方法：**
1. 检查并授予存储权限（见上方步骤）
2. 确保使用系统自带截图功能
3. 重启App并重试

---

##### 错误2：❌ 截图文件不存在
**说明：** 文件路径获取失败

**可能原因：**
- 存储权限未授予
- Android 版本兼容性问题

**解决方法：**
1. 完全卸载App
2. 重新安装
3. 重新授予所有权限
4. 重试

---

##### 错误3：❌ 网络错误：无法连接服务器
**说明：** 无法连接到服务器

**可能原因：**
- 手机没有联网
- WiFi/移动网络不稳定
- 服务器地址不可达
- 公司/学校网络有防火墙

**解决方法：**
1. 检查手机网络连接（WiFi或移动数据）
2. 尝试用浏览器访问：`http://shanghai.idc.matrixorigin.cn:30026/health`
3. 如果浏览器也无法访问，说明是网络环境问题
4. 尝试切换网络（WiFi ↔ 移动数据）
5. 如果在公司/学校，可能需要切换到个人网络

---

##### 错误4：❌ 网络超时
**说明：** 服务器响应时间过长

**可能原因：**
- 服务器正在处理大量请求
- 网络速度太慢
- 图片太大

**解决方法：**
1. 等待更长时间（最多5分钟）
2. 检查网络速度
3. 重试

---

##### 错误5：❌ 服务器错误
**说明：** 服务器内部错误

**可能原因：**
- 服务器崩溃或重启
- 服务器负载过高
- API 配置问题

**解决方法：**
1. 等待几分钟后重试
2. 检查服务器是否在运行（在电脑上检查）

---

##### 错误6：识别成功但英雄名字没更新
**说明：** 这是 UI 更新的 bug

**如果你看到了"识别成功: xxx, yyy, zzz..."的提示，但英雄名字还是"英雄1"至"英雄5"，请立即告诉我，这需要修复代码。**

---

### 第四步：如何反馈问题 📋

由于你在手机上测试，无法直接查看Logcat，请按以下格式反馈：

#### 基本信息：
```
手机型号：
Android 版本：
网络类型：WiFi / 移动数据
```

#### 测试结果：
```
1. 是否看到"正在识别英雄..."？ 是/否

2. 如果是，显示的文件大小是多少？ ___ KB

3. 等待多久？ ___ 分钟

4. 最终看到什么提示？
   [ ] 识别成功: xxx, yyy, ...
   [ ] ❌ 网络错误
   [ ] ❌ 截图文件不存在
   [ ] ❌ 网络超时
   [ ] ❌ 服务器错误
   [ ] 其他：___________

5. 英雄名字是否更新？ 是/否

6. 如果部分更新，哪些更新了？
   英雄1: ___
   英雄2: ___
   英雄3: ___
   英雄4: ___
   英雄5: ___
```

#### 网络测试：
```
1. 手机浏览器能否访问这个地址？
   http://shanghai.idc.matrixorigin.cn:30026/health
   
   [ ] 可以访问，显示JSON
   [ ] 无法访问
   [ ] 显示其他内容：___________
```

---

### 第五步：临时解决方案 🔧

如果网络确实有问题，我可以提供两个解决方案：

#### 方案1：更换服务器地址
如果公司/学校网络限制了外部访问，可以：
1. 部署一个本地服务器
2. 修改App中的服务器地址
3. 使用局域网IP

#### 方案2：使用测试模式
我可以创建一个测试版本：
- 不连接服务器
- 使用模拟数据
- 验证 UI 更新功能是否正常

---

## 快速诊断清单 ✓

截图后，按顺序检查：

- [ ] 看到 Toast："正在识别英雄..."
  - 如果没有 → 存储权限问题
  
- [ ] 显示文件大小
  - 如果没有 → 文件访问失败
  
- [ ] 等待30秒-2分钟
  
- [ ] 看到"识别成功"或错误提示
  - 如果什么都没有 → 网络请求卡住
  
- [ ] 英雄名字更新
  - 如果没有 → UI 更新失败（需要修复）

---

## 需要帮助？

根据上面的测试结果，告诉我你遇到的具体问题，我会帮你解决！🚀

